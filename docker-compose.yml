version: "3.9"

services:
  backend:
    build: .
    command: uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
    ports:
      - "8000:8000"
    environment:
      - ICONFORGE_PROJECT_NAME=IconForge
      - ICONFORGE_API_PREFIX=/api/v1
      - ICONFORGE_TEMP_DIR=/tmp/iconforge/temp
      - ICONFORGE_MODEL_CACHE_DIR=/tmp/iconforge/models
      - ICONFORGE_MAX_UPLOAD_SIZE_BYTES=10485760
      - U2NET_HOME=/tmp/iconforge/models
    volumes:
      - ./:/app
      - ./tmp:/tmp/iconforge/temp
      - ./models:/tmp/iconforge/models
    working_dir: /app
